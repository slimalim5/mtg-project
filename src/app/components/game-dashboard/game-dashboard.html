<div class="dashboard">
  <mat-card class="content">
    <mat-card-header>
      <mat-card-title>Welcome to MTG 20 Questions!</mat-card-title>
      <mat-card-subtitle>Think of a Magic: The Gathering card, and I'll try to guess it in 20 questions or less.</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <div class="game-area">
        <button mat-raised-button color="primary" class="start-btn" (click)="getRandomCard()" [disabled]="loading()">
          <mat-icon>casino</mat-icon>
          Get Random Card
        </button>
      </div>

      <!-- Current Card Display -->
      @if (currentCard(); as card) {
        <mat-card class="card-info">
          <mat-card-header>
            <mat-card-title>Current Card</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <h3>{{ card.name }}</h3>
            <p><strong>Type:</strong> {{ card.type_line }}</p>
            <p><strong>CMC:</strong> {{ card.cmc }}</p>
            @if (card.card_faces && card.card_faces[0]) {
              <p>
                <strong>Mana Cost:</strong> {{ card.card_faces[0].mana_cost }}
              </p>
            }
            @if (card.card_faces && card.card_faces[0]) {
              <p>
                <strong>Oracle Text:</strong> {{ card.card_faces[0].oracle_text }}
              </p>
            }
            <p><strong>Rarity:</strong> {{ card.rarity }}</p>
            <p><strong>Set:</strong> {{ card.set_name }}</p>
          </mat-card-content>
        </mat-card>
      }

      <!-- Question Input -->
      @if (currentCard()) {
        <mat-card class="question-card">
          <mat-card-header>
            <mat-card-title>Ask a Question</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <mat-form-field class="full-width">
              <mat-label>Your question</mat-label>
              <input matInput [ngModel]="question()" (ngModelChange)="question.set($event)" placeholder="Is this card blue?" [disabled]="loading()">
            </mat-form-field>

            <button mat-raised-button color="accent" (click)="askQuestion()" [disabled]="loading() || !question().trim()">
              <mat-icon>send</mat-icon>
              Ask Question
            </button>

            <!-- Loading Spinner -->
            @if (loading()) {
              <div class="spinner-container">
                <mat-spinner diameter="40"></mat-spinner>
              </div>
            }

            <!-- Error Display -->
            @if (error()) {
              <div class="error-message">
                <mat-icon color="warn">error</mat-icon>
                {{ error() }}
              </div>
            }

            <!-- Answer Display -->
            @if (answer()) {
              <div class="answer-display">
                <h4>Answer:</h4>
                <p>{{ answer() }}</p>
              </div>
            }
          </mat-card-content>
        </mat-card>
      }

      <mat-card class="info-card">
        <mat-card-header>
          <mat-card-title>How to play</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-list>
            <mat-list-item>
              <mat-icon matListItemIcon>casino</mat-icon>
              <span matListItemTitle>Click "Get Random Card" to select a card</span>
            </mat-list-item>
            <mat-list-item>
              <mat-icon matListItemIcon>quiz</mat-icon>
              <span matListItemTitle>Ask questions about the card</span>
            </mat-list-item>
            <mat-list-item>
              <mat-icon matListItemIcon>smart_toy</mat-icon>
              <span matListItemTitle>The AI will answer based on the card's properties</span>
            </mat-list-item>
            <mat-list-item>
              <mat-icon matListItemIcon>timer</mat-icon>
              <span matListItemTitle>Try to guess the card in 20 questions or less</span>
            </mat-list-item>
          </mat-list>
        </mat-card-content>
      </mat-card>
    </mat-card-content>
  </mat-card>
</div>